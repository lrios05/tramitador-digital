<div class="container">
    <mat-card>
        <mat-card-header>
            <mat-card-title>Registro de trámites</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <form [formGroup]="noteForm" (ngSubmit)="onRegister()">
                <div class="vertical-form-field">
                    <mat-form-field appearance="standard" class="mid-width">
                        <mat-label>Rol de origen</mat-label>
                        <mat-select formControlName="fromRoleId" (selectionChange)="fromRoleHandler($event)"
                            placeholder="Seleccionar rol">
                            <mat-option *ngFor="let item of roles" [value]="item.role">
                                {{ item.description }}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="noteForm.controls['fromRoleId'].invalid">
                            Seleccione rol de origen
                        </mat-error>
                    </mat-form-field>
                    <mat-form-field appearance="standard" class="mid-width">
                        <mat-label>Usuario de origen</mat-label>
                        <mat-select formControlName="fromUserId" placeholder="Seleccionar usuario">
                            <mat-option *ngFor="let item of usersFrom" [value]="item.userId">
                                {{ item.userName }}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="noteForm.controls['fromUserId'].invalid">
                            Seleccione usuario de origen
                        </mat-error>
                    </mat-form-field>
                </div>
                <div class="vertical-form-field">
                    <mat-form-field appearance="standard" class="full-width">
                        <mat-label>Referencia</mat-label>
                        <input matInput formControlName="subject" placeholder="Ingrese la referencia de la nota"
                            maxlength="100">
                        <mat-error *ngIf="noteForm.controls['subject'].invalid">
                            Ingrese la referencia de la nota
                        </mat-error>
                    </mat-form-field>
                </div>
                <div class="vertical-form-field" fxLayout="row">
                    <div class="input-group quart-width">
                        <input type="text" formControlName="contract" class="form-control"
                            placeholder="Nro. de Contrato">
                        <div class="input-group-append">
                            <button class="btn btn-secondary" type="button" (click)="getDocuments()">
                                <mat-icon>search</mat-icon>
                            </button>
                        </div>
                    </div>
                    <mat-nav-list fxLayout="row">
                        <mat-list-item *ngFor="let doc of documents">
                            <a matLine href="#">{{ doc.docName }}</a>
                            <button mat-icon-button (click)="showDocument(doc.docName)">
                                <mat-icon>info</mat-icon>
                            </button>
                        </mat-list-item>
                    </mat-nav-list>
                </div>

                <div class="vertical-form-field">
                    <input hidden=true matInput formControlName="userId">
                </div>

                <div class="sub-title">
                    Instrucciones del tramite
                </div>
                <div class="vertical-form-field">
                    <mat-form-field appearance="standard" class="mid-width">
                        <mat-label>Prioridad del tramite</mat-label>
                        <mat-select formControlName="priority" placeholder="Seleccionar tipo residuo">
                            <mat-option *ngFor="let item of priorities" [value]="item.value">
                                {{ item.display }}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="noteForm.controls['priority'].invalid">
                            Seleccione prioridad
                        </mat-error>
                    </mat-form-field>
                    <mat-form-field appearance="standard" class="quart-width">
                        <mat-label>Nro. de días</mat-label>
                        <input matInput type="number" formControlName="days" (keyup)="daysHandler($event)"
                            placeholder="Ingrese plazo de días" maxlength="5">
                    </mat-form-field>
                    <mat-form-field appearance="standard" class="quart-width">
                        <mat-label>Fecha límite</mat-label>
                        <input matInput formControlName="deadLine" [matDatepicker]="picker3">
                        <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                        <mat-datepicker #picker3></mat-datepicker>
                    </mat-form-field>
                </div>
                <div class="vertical-form-field">
                    <mat-form-field appearance="standard" class="mid-width">
                        <mat-label>Instrucción</mat-label>
                        <mat-select formControlName="instructionId" placeholder="Seleccionar instructivo">
                            <mat-option *ngFor="let note of instructions" [value]="note.instructionId">
                                {{ note.instruction }}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="noteForm.controls['instructionId'].invalid">
                            Seleccione el instructivo del trámite
                        </mat-error>
                    </mat-form-field>
                    <mat-form-field appearance="standard" class="mid-width">
                        <mat-label>Comentario</mat-label>
                        <input matInput formControlName="comment" placeholder="Enfasis del instructivo" maxlength="100">
                    </mat-form-field>
                </div>
                <div class="vertical-form-field">
                    <mat-form-field appearance="standard" class="mid-width">
                        <mat-label>Destinatario</mat-label>
                        <mat-select formControlName="toRoleId" (selectionChange)="toRoleHandler($event)"
                            placeholder="Seleccionar rol">
                            <mat-option *ngFor="let item of roles" [value]="item.role">
                                {{ item.description }}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="noteForm.controls['toRoleId'].invalid">
                            Seleccione rol de destino
                        </mat-error>
                    </mat-form-field>
                    <mat-form-field appearance="standard" class="mid-width">
                        <mat-label>Usuario destino</mat-label>
                        <mat-select formControlName="toUserId" placeholder="Seleccionar Usuario">
                            <mat-option *ngFor="let item of usersTo" [value]="item.userId">
                                {{ item.userName }}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="noteForm.controls['toUserId'].invalid">
                            Seleccione usuario destino
                        </mat-error>
                    </mat-form-field>
                </div>
                <mat-card-actions>
                    <button type="submit" mat-raised-button color="primary"
                        [disabled]="noteForm.invalid">Registrar</button>
                </mat-card-actions>
            </form>
        </mat-card-content>
    </mat-card>
</div>